{"remainingRequest":"/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/node_modules/babel-loader/lib/index.js!/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/src/components/SongUploadDialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/src/components/SongUploadDialog.vue","mtime":1619515702000},{"path":"/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5lbmRzLXdpdGguanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHVwbG9hZGluZzogZmFsc2UsCiAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICBzb25nOiB7fSwKICAgICAgc2VsZWN0ZWRGaWVsZDogW10sCiAgICAgIHVwbG9hZEZpbGU6IG51bGwsCiAgICAgIGZpbGVMaXN0OiBbXSwKICAgICAgb3B0aW9uczogW3sKICAgICAgICB2YWx1ZTogJ3NvbmdJbmZvJywKICAgICAgICBsYWJlbDogJ+atjOabsuS/oeaBrycsCiAgICAgICAgY2hpbGRyZW46IFt7CiAgICAgICAgICB2YWx1ZTogJ2FsYnVtJywKICAgICAgICAgIGxhYmVsOiAn5LiT6L6R5Zu+JwogICAgICAgIH1dCiAgICAgIH0sIHsKICAgICAgICB2YWx1ZTogJ2FjY29tcGFueVNpbmcnLAogICAgICAgIGxhYmVsOiAn5Ly05aWP5ryU5ZSx5qih5byPJywKICAgICAgICBjaGlsZHJlbjogW3sKICAgICAgICAgIHZhbHVlOiAnb3JpZ2luYWwnLAogICAgICAgICAgbGFiZWw6ICfljp/llLHpn7PpopEnCiAgICAgICAgfSwgewogICAgICAgICAgdmFsdWU6ICdhY2NvbXBhbnlfYWNjb21wYW55JywKICAgICAgICAgIGxhYmVsOiAn5Ly05aWP6Z+z6aKRJwogICAgICAgIH0sIHsKICAgICAgICAgIHZhbHVlOiAnbHlyaWMnLAogICAgICAgICAgbGFiZWw6ICfmrYzor40nCiAgICAgICAgfSwgewogICAgICAgICAgdmFsdWU6ICdtdicsCiAgICAgICAgICBsYWJlbDogJ01WJwogICAgICAgIH1dCiAgICAgIH0sIHsKICAgICAgICB2YWx1ZTogJ2luc3RydW1lbnRTaW5nJywKICAgICAgICBsYWJlbDogJ+iHquW8ueiHquWUseaooeW8jycsCiAgICAgICAgY2hpbGRyZW46IFt7CiAgICAgICAgICB2YWx1ZTogJ2luc3RydW1lbnQnLAogICAgICAgICAgbGFiZWw6ICflkozlvKYnCiAgICAgICAgfSwgewogICAgICAgICAgdmFsdWU6ICdhY2NvbXBhbnlfaW5zdHJ1bWVudCcsCiAgICAgICAgICBsYWJlbDogJ+S8tOWljycKICAgICAgICB9XQogICAgICB9LCB7CiAgICAgICAgdmFsdWU6ICdyYXRpbmcnLAogICAgICAgIGxhYmVsOiAn5q2M5puy5omT5YiGJywKICAgICAgICBjaGlsZHJlbjogW3sKICAgICAgICAgIHZhbHVlOiAncmF0ZScsCiAgICAgICAgICBsYWJlbDogJ+S6uuWjsOmfs+mikScKICAgICAgICB9XQogICAgICB9XQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBmaWVsZDogZnVuY3Rpb24gZmllbGQoKSB7CiAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkRmllbGQubGVuZ3RoID09PSAyID8gdGhpcy5zZWxlY3RlZEZpZWxkWzFdIDogJyc7CiAgICB9LAogICAgZmlsZVN1ZmZpeDogZnVuY3Rpb24gZmlsZVN1ZmZpeCgpIHsKICAgICAgdmFyIHR5cGVUb1N1ZmZpeCA9IHsKICAgICAgICAnb3JpZ2luYWwnOiAnd2F2JywKICAgICAgICAnYWNjb21wYW55X2FjY29tcGFueSc6ICd3YXYnLAogICAgICAgICdseXJpYyc6ICdscmMnLAogICAgICAgICdtdic6ICdtcDQnLAogICAgICAgICdpbnN0cnVtZW50JzogJ3R4dCcsCiAgICAgICAgJ2FjY29tcGFueV9pbnN0cnVtZW50JzogJ3dhdicsCiAgICAgICAgJ3JhdGUnOiAnd2F2JwogICAgICB9OwogICAgICBpZiAodGhpcy5maWVsZCBpbiB0eXBlVG9TdWZmaXgpIHJldHVybiB0eXBlVG9TdWZmaXhbdGhpcy5maWVsZF07CiAgICAgIHJldHVybiAnJzsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGhhbmRsZUNhc2NhZGVyQ2hhbmdlOiBmdW5jdGlvbiBoYW5kbGVDYXNjYWRlckNoYW5nZSgpIHsKICAgICAgdGhpcy51cGxvYWRGaWxlID0gbnVsbDsKICAgICAgdGhpcy5maWxlTGlzdCA9IFtdOwogICAgfSwKICAgIGhhbmRsZUNhbmNlbDogZnVuY3Rpb24gaGFuZGxlQ2FuY2VsKCkgewogICAgICB0aGlzLnJlc2V0RGlhbG9nKCk7CiAgICB9LAogICAgaGFuZGxlU3VibWl0OiBmdW5jdGlvbiBoYW5kbGVTdWJtaXQoKSB7CiAgICAgIGlmICh0aGlzLnVwbG9hZEZpbGUgPT09IG51bGwpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIG1lc3NhZ2U6ICfor7fpgInmi6nkuIrkvKDmlofku7bvvIEnLAogICAgICAgICAgdHlwZTogJ2Vycm9yJwogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy51cGxvYWRpbmcgPSB0cnVlOwogICAgICB0aGlzLiRlbWl0KCd1cGRhdGUtc29uZycsIHRoaXMuc29uZy5pZCk7CiAgICB9LAogICAgaGFuZGxlRmlsZVJlbW92ZTogZnVuY3Rpb24gaGFuZGxlRmlsZVJlbW92ZSgpIHsKICAgICAgdGhpcy51cGxvYWRGaWxlID0gbnVsbDsKICAgIH0sCiAgICBoYW5kbGVGaWxlQ2hhbmdlOiBmdW5jdGlvbiBoYW5kbGVGaWxlQ2hhbmdlKGZpbGUpIHsKICAgICAgaWYgKGZpbGUucmF3KSB7CiAgICAgICAgdmFyIGZpbGVPYmogPSBmaWxlLnJhdzsKCiAgICAgICAgaWYgKCF0aGlzLmNoZWNrRmlsZVR5cGUoZmlsZU9iaikpIHsKICAgICAgICAgIHRoaXMuZmlsZUxpc3QgPSBbXTsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICBtZXNzYWdlOiAn5paH5Lu25qC85byP5LiN56ym5ZCI6KaB5rGC77yBJywKICAgICAgICAgICAgdHlwZTogJ2Vycm9yJwogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMudXBsb2FkRmlsZSA9IGZpbGVPYmo7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgaGFuZGxlRmlsZU51bWJlckV4Y2VlZDogZnVuY3Rpb24gaGFuZGxlRmlsZU51bWJlckV4Y2VlZCgpIHsKICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfpmZDliLbpgInmi6kx5Liq5paH5Lu2Jyk7CiAgICB9LAogICAgY2hlY2tGaWxlVHlwZTogZnVuY3Rpb24gY2hlY2tGaWxlVHlwZShmaWxlT2JqKSB7CiAgICAgIHZhciBmaWxlbmFtZSA9IGZpbGVPYmoubmFtZTsKICAgICAgdmFyIHN1ZmZpeCA9IHRoaXMuZmlsZVN1ZmZpeDsKCiAgICAgIGlmIChzdWZmaXgubGVuZ3RoICE9PSAwKSB7CiAgICAgICAgdmFyIHN1ZmZpeFdpdGhEb3QgPSAnLicgKyBzdWZmaXg7CiAgICAgICAgcmV0dXJuIGZpbGVuYW1lLmVuZHNXaXRoKHN1ZmZpeFdpdGhEb3QpOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0sCiAgICByZXNldERpYWxvZzogZnVuY3Rpb24gcmVzZXREaWFsb2coKSB7CiAgICAgIHRoaXMudXBsb2FkRmlsZSA9IG51bGw7CiAgICAgIHRoaXMuZmlsZUxpc3QgPSBbXTsKICAgICAgdGhpcy5zZWxlY3RlZEZpZWxkID0gW107CiAgICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlOwogICAgfQogIH0KfTs="},{"version":3,"sources":["SongUploadDialog.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <el-dialog \n    title=\"上传文件\"\n    width=\"27%\"\n    :visible.sync=\"visible\" \n    @closed=\"resetDialog\"\n  >\n\n  <div class=\"dialog-body\">\n    <el-cascader\n      class=\"file-type-selector\"\n      placeholder=\"请选择文件类型\"\n      v-model=\"selectedField\"\n      :options=\"options\"\n      @change=\"handleCascaderChange\" \n    />\n\n    <el-upload\n      v-show=\"field === 'album'\"\n      class=\"upload-form\"\n      action=\"https://jsonplaceholder.typicode.com/posts/\"\n      accept=\"image/png\"\n      :on-remove=\"handleFileRemove\"\n      :on-change=\"handleFileChange\"\n      :on-exceed=\"handleFileNumberExceed\"\n      :limit=\"1\"\n      :file-list=\"fileList\"\n      list-type=\"picture\"\n      :auto-upload=\"false\"\n    >\n      <el-button size=\"small\" type=\"primary\">选择图片</el-button>\n      <div slot=\"tip\" class=\"el-upload__tip\">请上传png文件</div>\n    </el-upload>\n\n    <el-upload\n      v-show=\"field !== '' && field !== 'album'\"\n      class=\"upload-form upload-demo\"\n      action=\"https://jsonplaceholder.typicode.com/posts/\"\n      :on-remove=\"handleFileRemove\"\n      :on-change=\"handleFileChange\"\n      :on-exceed=\"handleFileNumberExceed\"\n      :limit=\"1\"\n      :file-list=\"fileList\"\n      :auto-upload=\"false\"\n    >\n      <el-button size=\"small\" type=\"primary\">选择文件</el-button>\n      <div slot=\"tip\" class=\"el-upload__tip\">请上传{{fileSuffix}}文件</div>\n    </el-upload>\n\n    </div>\n\n    <div slot=\"footer\" class=\"dialog-footer\">\n      <el-button @click=\"handleCancel\">取消</el-button>\n      <el-button type=\"primary\" @click=\"handleSubmit\" :loading=\"uploading\">确定</el-button>\n    </div>\n\n  </el-dialog>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      uploading: false,\n      visible: false,\n      song: {},\n      selectedField: [],\n      uploadFile: null,\n      fileList: [],\n      options: [\n        {\n          value: 'songInfo',\n          label: '歌曲信息',\n          children: [\n            {\n              value: 'album',\n              label: '专辑图',\n            },\n          ],\n        },\n        {\n          value: 'accompanySing',\n          label: '伴奏演唱模式',\n          children: [\n            {\n              value: 'original',\n              label: '原唱音频',\n            },\n            {\n              value: 'accompany_accompany',\n              label: '伴奏音频',\n            },\n            {\n              value: 'lyric',\n              label: '歌词',\n            },\n            {\n              value: 'mv',\n              label: 'MV',\n            },\n          ],\n        },\n        {\n          value: 'instrumentSing',\n          label: '自弹自唱模式',\n          children: [\n            {\n              value: 'instrument',\n              label: '和弦',\n            },\n            {\n              value: 'accompany_instrument',\n              label: '伴奏',\n            },\n          ],\n        },\n        {\n          value: 'rating',\n          label: '歌曲打分',\n          children: [\n            {\n              value: 'rate',\n              label: '人声音频',\n            },\n          ],\n        },\n      ],\n    };\n  },\n\n  computed: {\n    field: function() {\n      return this.selectedField.length === 2 ? this.selectedField[1] : '';\n    },\n    fileSuffix: function() {\n      const typeToSuffix = {\n        'original': 'wav',\n        'accompany_accompany': 'wav',\n        'lyric': 'lrc',\n        'mv': 'mp4',\n        'instrument': 'txt',\n        'accompany_instrument': 'wav',\n        'rate': 'wav',\n      };\n      if (this.field in typeToSuffix)\n        return typeToSuffix[this.field];\n      return '';\n    }\n  },\n\n  methods: {\n    handleCascaderChange() {\n      this.uploadFile = null;\n      this.fileList = [];\n    },\n    handleCancel() {\n      this.resetDialog();\n    },\n    handleSubmit() {\n      if (this.uploadFile === null) {\n        this.$message({\n          message: '请选择上传文件！',\n          type: 'error',\n        });\n        return;\n      }\n      this.uploading = true;\n      this.$emit('update-song', this.song.id);\n    },\n    handleFileRemove() {\n      this.uploadFile = null;\n    },\n    handleFileChange(file) {\n      if (file.raw) {\n        let fileObj = file.raw;\n        if (!this.checkFileType(fileObj)) {\n          this.fileList = [];\n          this.$message({\n            message: '文件格式不符合要求！',\n            type: 'error',\n          });\n        } else {\n          this.uploadFile = fileObj;\n        }\n      }\n    },\n    handleFileNumberExceed() {\n      this.$message.warning('限制选择1个文件');\n    },\n\n    checkFileType(fileObj) {\n      const filename = fileObj.name;\n      const suffix = this.fileSuffix;\n      if (suffix.length !== 0) {\n        let suffixWithDot = '.' + suffix;\n        return filename.endsWith(suffixWithDot);\n      }\n      return true;\n    },\n    resetDialog() {\n      this.uploadFile = null;\n      this.fileList = [];\n      this.selectedField = [];\n      this.visible = false;\n    },\n  },\n\n\n};\n</script>\n\n<style scoped>\n\n.dialog-body {\n  position: relative;\n  height: 230px;\n}\n\n.upload-form {\n  display: block;\n  margin-left: 3px;\n}\n\n.file-type-selector {\n  margin-bottom: 20px;\n  width: 200px;\n}\n\n</style>"],"sourceRoot":"src/components"}]}