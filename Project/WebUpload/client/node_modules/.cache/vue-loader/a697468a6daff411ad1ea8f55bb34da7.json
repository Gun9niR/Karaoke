{"remainingRequest":"/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/src/components/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/src/components/Login.vue","mtime":1616253354000},{"path":"/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/david/Study/SJTU/Courses/SE/Karaoke/Project/WebUpload/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBBbGVydCBmcm9tICIuL0FsZXJ0IjsKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgdmFyIHZhbGlkYXRlTmFtZSA9IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsKICAgICAgaWYgKHZhbHVlID09PSAiIikgewogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi6K+36L6T5YWl55So5oi35ZCNIikpOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0aGlzLnJ1bGVGb3JtLnBhc3MgIT09ICIiKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLnJ1bGVGb3JtLnZhbGlkYXRlRmllbGQoInBhc3MiKTsKICAgICAgICB9CiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgfQogICAgfTsKCiAgICB2YXIgdmFsaWRhdGVQYXNzID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICBpZiAodmFsdWUgPT09ICIiKSB7CiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCLor7fovpPlhaXlr4bnoIEiKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gewogICAgICBzaG93RXJyb3JNZXNzYWdlOiBmYWxzZSwKICAgICAgcnVsZUZvcm06IHsKICAgICAgICBuYW1lOiAiIiwKICAgICAgICBwYXNzOiAiIiwKICAgICAgfSwKICAgICAgcnVsZXM6IHsKICAgICAgICBuYW1lOiBbeyB2YWxpZGF0b3I6IHZhbGlkYXRlTmFtZSwgdHJpZ2dlcjogImJsdXIiIH1dLAogICAgICAgIHBhc3M6IFt7IHZhbGlkYXRvcjogdmFsaWRhdGVQYXNzLCB0cmlnZ2VyOiAiYmx1ciIgfV0sCiAgICAgIH0sCiAgICB9OwogIH0sCgogIGNvbXBvbmVudHM6IHsKICAgIGFsZXJ0OiBBbGVydCwKICB9LAoKICBtZXRob2RzOiB7CiAgICB2ZXJpZnkocGF5bG9hZCkgewogICAgICBheGlvcwogICAgICAgIC5wb3N0KCIvdmVyaWZ5IiwgcGF5bG9hZCkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzID09PSAwKSB7CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgcGF0aDogIi91cGxvYWQiIH0pOwogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoImxvZ2luIik7CiAgICAgICAgICAgIC8vIHZhciBleHBpcmUgPSA1MDAwOwogICAgICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgLy8gICB0aGlzLiRzdG9yZS5jb21taXQoImxvZ2luRXhwaXJlIik7CiAgICAgICAgICAgIC8vIH0sIGV4cGlyZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnNob3dFcnJvck1lc3NhZ2UgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKCgpID0+IHsKICAgICAgICAgIGFsZXJ0KCJFcnJvciEgVGhlcmUgbWF5IGJlIHNvbWV0aGluZyB3cm9uZyEiKTsKICAgICAgICB9KTsKICAgIH0sCgogICAgaW5pdEZvcm0oKSB7CiAgICAgIHRoaXMucnVsZUZvcm0ubmFtZSA9ICIiOwogICAgICB0aGlzLnJ1bGVGb3JtLnBhc3MgPSAiIjsKICAgIH0sCgogICAgc3VibWl0Rm9ybShmb3JtTmFtZSkgewogICAgICB0aGlzLiRyZWZzW2Zvcm1OYW1lXS52YWxpZGF0ZSgodmFsaWQpID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIGNvbnN0IHBheWxvYWQgPSB7CiAgICAgICAgICAgIG5hbWU6IHRoaXMucnVsZUZvcm0ubmFtZSwKICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMucnVsZUZvcm0ucGFzcywKICAgICAgICAgIH07CiAgICAgICAgICB0aGlzLnZlcmlmeShwYXlsb2FkKTsKICAgICAgICAgIHRoaXMuaW5pdEZvcm0oKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coImVycm9yIHN1Ym1pdCEhIik7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICByZXNldEZvcm0oZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0ucmVzZXRGaWVsZHMoKTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <alert v-if=\"showErrorMessage\"></alert>\n\n    <el-card class=\"box-card\" id=\"login-card\">\n      <div id=\"title-wrapper\"><h2>管理员登录</h2></div>\n\n      <div id=\"login-form-wrapper\">\n        <el-form\n          :model=\"ruleForm\"\n          status-icon\n          :rules=\"rules\"\n          ref=\"ruleForm\"\n          label-width=\"100px\"\n          class=\"demo-ruleForm\"\n        >\n          <el-form-item label=\"用户名\" prop=\"name\">\n            <el-input v-model=\"ruleForm.name\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n\n          <el-form-item label=\"密码\" prop=\"pass\">\n            <el-input\n              type=\"password\"\n              v-model=\"ruleForm.pass\"\n              autocomplete=\"off\"\n            ></el-input>\n          </el-form-item>\n\n          <el-form-item id=\"button-wrapper\">\n            <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">登录</el-button>\n            <el-button @click=\"resetForm('ruleForm')\">清空</el-button>\n          </el-form-item>\n        </el-form>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport Alert from \"./Alert\";\n\nexport default {\n  data() {\n    var validateName = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请输入用户名\"));\n      } else {\n        if (this.ruleForm.pass !== \"\") {\n          this.$refs.ruleForm.validateField(\"pass\");\n        }\n        callback();\n      }\n    };\n\n    var validatePass = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请输入密码\"));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      showErrorMessage: false,\n      ruleForm: {\n        name: \"\",\n        pass: \"\",\n      },\n      rules: {\n        name: [{ validator: validateName, trigger: \"blur\" }],\n        pass: [{ validator: validatePass, trigger: \"blur\" }],\n      },\n    };\n  },\n\n  components: {\n    alert: Alert,\n  },\n\n  methods: {\n    verify(payload) {\n      axios\n        .post(\"/verify\", payload)\n        .then((res) => {\n          if (res.data.status === 0) {\n            this.$router.push({ path: \"/upload\" });\n            this.$store.commit(\"login\");\n            // var expire = 5000;\n            // setTimeout(() => {\n            //   this.$store.commit(\"loginExpire\");\n            // }, expire);\n          } else {\n            this.showErrorMessage = true;\n          }\n        })\n        .catch(() => {\n          alert(\"Error! There may be something wrong!\");\n        });\n    },\n\n    initForm() {\n      this.ruleForm.name = \"\";\n      this.ruleForm.pass = \"\";\n    },\n\n    submitForm(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          const payload = {\n            name: this.ruleForm.name,\n            password: this.ruleForm.pass,\n          };\n          this.verify(payload);\n          this.initForm();\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n    },\n  },\n};\n</script>\n\n<style scoped>\n#login-card {\n  max-width: 500px;\n  max-height: 350px;\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  margin: auto;\n}\n\n#title-wrapper {\n  margin: 35px;\n  font-size: 18.5px;\n}\n\n#login-form-wrapper {\n  max-width: 430px;\n  margin: 0 auto;\n  padding-right: 50px;\n}\n\n#button-wrapper {\n  margin: 0, auto;\n  padding-right: 40px;\n}\n\n#login-card {\n  text-align: center;\n}\n</style>\n"]}]}